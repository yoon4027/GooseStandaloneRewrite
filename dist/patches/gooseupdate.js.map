{"version":3,"sources":["../../src/patches/gooseupdate.ts"],"sourcesContent":["import { Patch } from \"#lib/structures\";\nimport { replaceInFile } from \"#lib/util\";\nimport type { DiscordClientType } from \"#types/types\";\nimport Inquirer from \"inquirer\";\nimport { join } from \"node:path\";\n\nexport class UserPatch extends Patch {\n  public override async run({ asarExtractPath }: Patch.Args) {\n    let { branch } = (await Inquirer.prompt([\n      {\n        type: \"checkbox\",\n\n        name: \"branch\",\n\n        message: \"GooseUpdate mods\",\n\n        choices: [\n          \"smartcord\",\n          \"betterdiscord\",\n\n          { name: \"goosemod\", checked: true },\n        ],\n      },\n    ])) as { branch: DiscordClientType[] | string };\n\n    (branch as string) = (branch as DiscordClientType[]).join(\"+\");\n\n    await replaceInFile({\n      filePath: join(asarExtractPath, \"app_bootstrap\", \"Constants.js\"),\n      toReplace: `const UPDATE_ENDPOINT = settings.get('UPDATE_ENDPOINT') || API_ENDPOINT`,\n      replaceWith: `const UPDATE_ENDPOINT = settings.get('UPDATE_ENDPOINT') || 'https://updates.goosemod.com/${branch}'`,\n    });\n\n    await replaceInFile({\n      filePath: join(asarExtractPath, \"app_bootstrap\", \"Constants.js\"),\n      toReplace: `const NEW_UPDATE_ENDPOINT = settings.get('NEW_UPDATE_ENDPOINT') || 'https://discord.com/api/updates/'`,\n      replaceWith: `const NEW_UPDATE_ENDPOINT = settings.get('NEW_UPDATE_ENDPOINT') || 'https://updates.goosemod.com/${branch}/'`,\n    });\n\n    await replaceInFile({\n      filePath: join(asarExtractPath, \"common\", \"Settings.js\"),\n      toReplace: `return defaultValue`,\n      replaceWith: `return key === 'SKIP_HOST_UPDATE' ? true : defaultValue`,\n    });\n  }\n}\n"],"mappings":";;AAAA;AACA;AAEA;AACA;AAEO,MAAM,kBAAkB,MAAM;AAAA,EACnC,MAAsB,IAAI,EAAE,mBAA+B;AACzD,QAAI,EAAE,WAAY,MAAM,SAAS,OAAO;AAAA,MACtC;AAAA,QACE,MAAM;AAAA,QAEN,MAAM;AAAA,QAEN,SAAS;AAAA,QAET,SAAS;AAAA,UACP;AAAA,UACA;AAAA,UAEA,EAAE,MAAM,YAAY,SAAS,KAAK;AAAA,QACpC;AAAA,MACF;AAAA,IACF,CAAC;AAED,IAAC,SAAqB,OAA+B,KAAK,GAAG;AAE7D,UAAM,cAAc;AAAA,MAClB,UAAU,KAAK,iBAAiB,iBAAiB,cAAc;AAAA,MAC/D,WAAW;AAAA,MACX,aAAa,4FAA4F;AAAA,IAC3G,CAAC;AAED,UAAM,cAAc;AAAA,MAClB,UAAU,KAAK,iBAAiB,iBAAiB,cAAc;AAAA,MAC/D,WAAW;AAAA,MACX,aAAa,oGAAoG;AAAA,IACnH,CAAC;AAED,UAAM,cAAc;AAAA,MAClB,UAAU,KAAK,iBAAiB,UAAU,aAAa;AAAA,MACvD,WAAW;AAAA,MACX,aAAa;AAAA,IACf,CAAC;AAAA,EACH;AACF;AAvCa;","names":[]}